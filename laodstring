local player = game:GetService("Players").LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local hrp = character:WaitForChild("HumanoidRootPart")

-- Remove collisions
for _, part in ipairs(character:GetDescendants()) do
	if part:IsA("BasePart") then
		part.CanCollide = false
	end
end

local FLY_SPEED = 26
local ARRIVAL_THRESHOLD = 2
local visitedCoins = {}

local function forceMoveTo(targetPos)
	hrp.Velocity = Vector3.zero
	local startTime = tick()

	while (hrp.Position - targetPos).Magnitude > ARRIVAL_THRESHOLD do
		if tick() - startTime > 10 then
			hrp.Velocity = Vector3.zero
			return false
		end
		hrp.Velocity = (targetPos - hrp.Position).Unit * FLY_SPEED
		task.wait()
	end

	hrp.Velocity = Vector3.zero
	return true
end

local function getCoins()
	local coins = {}
	for _, coin in ipairs(workspace:GetDescendants()) do
		if coin:IsA("MeshPart") and coin.Name == "MainCoin" and not visitedCoins[coin] then
			table.insert(coins, coin)
		end
	end
	return coins
end

while true do
	local coins = getCoins()

	if #coins == 0 then
		task.wait(5)
		continue
	end

	-- Pick a random coin
	local coin = coins[math.random(#coins)]

	if coin and coin.Parent then
		local targetPos = coin.Position + Vector3.new(0, 0, 0)
		if forceMoveTo(targetPos) then
			visitedCoins[coin] = true
			coin:Destroy()
		end
	end

	task.wait(0.1)
end
